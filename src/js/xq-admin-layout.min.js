/*!
 * xq-admin-layout v1.0.1 (https://xqkeji.cn/demo/xq-adminpage)
 * Author xqkeji.cn
 * LICENSE SSPL-1.0
 * Copyright 2023 xqkeji.cn
 */
 "use strict";(()=>{var t="#xq-tab-fullscreen";var n="#xq-tab-left";var c="#xq-tab-right";var f="#xq-tab-nav";var m="#xq-tab-nav-ul";var d="#xq-tab-nav-ul>li>a.active";var o="#xq-tab-contentmenu";var r="#xq-tab-refresh";var s="#xq-tab-close-all";var l="#xq-tab-close-other";var b="#xq-sidebar";var e=".xq-fileinput";var a="#xq-top-nav";var i="mini";var u='[xq-widget="xq-mini-menu"]';var I="#xq-header";var R="#xq-content";var _="#xq-footer";var j=".xq-captcha";var v="#xq-tab-content";var z="#xq-tab-nav-ul .nav-item .nav-link button.close";var H="#xq-tab-nav-ul .nav-item .nav-link";var J="xq-menu";var y="bg-primary";var q="bg-dark";var S=".xq-logout";var p="bi-chevron-down";var g="bi-chevron-left";var G=()=>{const e=document.querySelector(j);if(e){e.addEventListener("click",e=>{const t=e.currentTarget;let n=t.getAttribute("src");if(n.includes("?")){n=n.slice(0,Math.max(0,n.lastIndexOf("?")));n=n+"?xq-r="+Math.random().toString()}else{n=n+"?xq-r="+Math.random().toString()}t.setAttribute("src",n)})}};var V=e=>{if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",e)}else{e()}};var P=(e,t)=>{const n=[];let c=e.parentNode;while(c&&c.nodeType===Node.ELEMENT_NODE&&c.nodeType!==3){if(c.matches(t)){n.push(c)}c=c.parentNode}return n};var L=(e,t)=>{const n=document.createRange().createContextualFragment(t);e.append(n)};var Q=(e,t)=>{const n=document.createRange().createContextualFragment(t);e.after(n)};var X=()=>{const t=document.querySelectorAll(e);if(t&&typeof jQuery!==void 0){let e;for(const n of t){e=n.hasAttribute("xq-config")?n.getAttribute("xq-config"):"{}";$(n).fileinput(JSON.parse(e)).on("filedeleted",e=>{const t=e.currentTarget;h(t)}).on("fileuploaded",e=>{const t=e.currentTarget;h(t)}).on("filesorted",e=>{const t=e.currentTarget;h(t)});h(n)}}};var h=e=>{const t=e.getAttribute("id");const n=t.replace("-xq-fileinput","");const c=document.querySelector("#"+n);const r=$(e).fileinput("getPreview");c?.setAttribute("value",JSON.stringify(r));const o=$(e).fileinput("getFilesCount",true);const s=e.getAttribute("xq-config");const l=JSON.parse(s);if("required"in l){if(o>0){e.removeAttribute("required")}else{e.setAttribute("required","true")}if("content"in r){const{content:a}=r;if(a.length===0){e.setCustomValidity("需要至少上传一个文件")}else{e.setCustomValidity("")}}}};var x=()=>{const e=document.querySelectorAll(S);if(e){for(const t of e){t.addEventListener("click",e=>{e.preventDefault();const t=e.currentTarget;const n=t.getAttribute("href");const c="xq-logout-form-"+Math.floor(Math.random()*1e3).toString();const r='<form action="'+n+'" method="post" style="display: none;" id="'+c+'"></form>';L(document.body,r);const o=document.querySelector("#"+c);o.submit()})}}};var A={scrollbarTheme:"os-theme-light",scrollbarAutoHide:"leave"};var k=null;var E=null;var N=()=>{if(typeof OverlayScrollbarsGlobal!=="undefined"){E=OverlayScrollbarsGlobal.OverlayScrollbars;if(!k){k=E(document.querySelector(b),{className:A.scrollbarTheme,sizeAutoCapable:true,scrollbars:{autoHide:A.scrollbarAutoHide,clickScrolling:true}})}}};var Y=()=>{if(k){k.destroy();k=null}};var B=()=>{const e=document.querySelector(a);if(e!==null){const l=e.querySelectorAll("li a:not([xq-widget])");for(const t of l){t.addEventListener("click",e=>{e.preventDefault();const t=e.currentTarget;const n=t.getAttribute("href");const c=document.querySelector(n);if(c?.classList.contains("d-none")){for(const r of l){if(r!==t){if(!r.classList.contains("bg-dark")){r.classList.add("bg-dark")}if(r.classList.contains("bg-primary")){r.classList.remove("bg-primary")}const o=r.getAttribute("href");const s=document.querySelector(o);if(!s?.classList.contains("d-none")){s?.classList.add("d-none")}}else{if(r.classList.contains("bg-dark")){r.classList.remove("bg-dark")}if(!r.classList.contains("bg-primary")){r.classList.add("bg-primary")}const o=r.getAttribute("href");const s=document.querySelector(o);if(s?.classList.contains("d-none")){s?.classList.remove("d-none")}}}}})}}};var K=()=>{const e=document.querySelector(u);if(e){e.addEventListener("click",e=>{e.preventDefault();const t=document.querySelector(I);if(t){if(t.classList.contains(i)){t.classList.remove(i)}else{t.classList.add(i)}}const n=document.querySelector(b);if(n){if(n.classList.contains(i)){n.classList.remove(i);N()}else{n.classList.add(i);Y()}}const c=document.querySelector(R);if(c){if(c.classList.contains(i)){c.classList.remove(i)}else{c.classList.add(i)}}const r=document.querySelector(_);if(r){if(r.classList.contains(i)){r.classList.remove(i)}else{r.classList.add(i)}}})}};var U=e=>{let t=null;const n=document.querySelector(m);const c=n.querySelectorAll("li");for(const r of c){if(r===e){break}t=r}return t};var w=e=>{const t=document.querySelector(m);const n=document.querySelector(v);const c=t.querySelector("li > a#"+e+"-tab");if(c===null){return}const r=t.querySelector("li > a.active");if(r){r.classList.remove("active")}if(c){c.classList.add("active")}const o=n.querySelector("div.active");if(o){o.classList.remove("active")}const s=n.querySelector("#"+e+"-tab-content");if(s){s.classList.add("active")}Z(e)};var Z=t=>{const e=document.querySelector(f);const n=document.querySelector(m);const c=n.querySelector("li:first-child");const r=Number.isNaN(Number.parseInt(c.style.marginLeft,10))?0:Number.parseInt(c.style.marginLeft,10);const o=Math.abs(r);const s=n.clientWidth+o;const l=e.clientWidth;let a=0;if(s>l){const i=n.querySelector("#"+t+"-tab");const u=n.querySelectorAll("li>a");let e=0;for(const d of u){e+=d.clientWidth;if(d===i){break}}if(r+e>l){a=l-e;c.style.marginLeft=a<0?a.toString()+"px":"0px"}}else{c.style.marginLeft="0px"}};var ee=()=>{const e=document.querySelectorAll(z);for(const t of e){T(t)}};var T=e=>{e.addEventListener("click",e=>{e.preventDefault();const t=document.querySelector(v);const n=e.currentTarget;const c=n.parentNode;const r=c.getAttribute("id");const o=r.replace("-tab","");const s=c?.parentNode;if(c.classList.contains("active")){const l=U(s);const a=l.querySelector("a");const i=a.getAttribute("id");const u=i.replace("-tab","");s.remove();t.querySelector("#"+o+"-tab-content")?.remove();w(u)}else{s.remove();t.querySelector("#"+o+"-tab-content")?.remove();w(o)}})};var te=()=>{const e=document.querySelectorAll(H);for(const t of e){const n=t.getAttribute("id");if(n!==null){D(n.replace("-tab",""))}}};var D=e=>{const t=document.querySelector(m);const n=t.querySelector("li > a#"+e+"-tab");if(n){n.addEventListener("click",e=>{const t=e.currentTarget;const n=t.getAttribute("id");w(n.replace("-tab",""))})}};var F=e=>{if(e){const t=document.querySelector(m);const n=t.querySelectorAll("li a button.close");for(const l of n){l.click()}const c=t.querySelector("li:first-child");const r=c.querySelector("a");r?.classList.add("acitve");const o=r?.getAttribute("data-bs-target");const s=document.querySelector(o);if(s){s?.classList.add("acitve")}if(c){c.style.marginLeft="0px"}}else{const t=document.querySelector(m);const n=t.querySelectorAll("li a:not(.active)");for(const l of n){const u=l.querySelector("button.close");u.click()}const a=document.querySelector(d);a.classList.add("acitve");const i=a?.getAttribute("data-bs-target");const s=document.querySelector(i);const c=t.querySelector("li:first-child");if(s){s?.classList.add("acitve")}if(c){c.style.marginLeft="0px"}}};var ne=null;var O=e=>{e.addEventListener("contextmenu",e=>{e.preventDefault();const t=e.currentTarget;ne=t;const n=e.pageY;const c=e.pageX;const r=document.querySelector(o);r.style.top=n+"px";r.style.left=c+"px";r.style.display="block"})};var ce=()=>{const e=document.querySelector(m);if(e!==null){const t=e.querySelectorAll("li>a");for(const n of t){O(n)}}};var re=e=>{const t=e.currentTarget;let n=document.querySelector(o);if(n===null){n=window.parent.document.querySelector(o)}if(n&&!n.contains(t)){n.style.display="none"}};var oe=()=>{const e=document.querySelector(r);const t=document.querySelector(s);const n=document.querySelector(l);if(e!==null){e.addEventListener("click",e=>{e.preventDefault();const t=document.querySelector(d);const n=t.getAttribute("data-bs-target");if(n!==null){const c=document.querySelector(n);if(c!==null){const r=c.querySelector("iframe");if(r!==null){r.contentWindow?.location.reload()}}}})}if(t!==null){t.addEventListener("click",e=>{e.preventDefault();F(true)})}if(n){n.addEventListener("click",e=>{e.preventDefault();F(false)})}};var W=(t,n,c)=>{let e=false;const r=document.querySelector(m);const o=document.querySelector(v);const s=r.querySelector("li > a#"+t+"-tab");if(s===null){let e='<li class="nav-item" role="presentation"><a class="nav-link" id="'+t+'-tab" data-bs-toggle="tab" data-bs-target="#'+t+'-tab-content" type="button" role="tab" aria-controls="'+t+'-tab-content" aria-selected="false">'+n+'<button type="button" class="close" aria-label="关闭"><span aria-hidden="true">&times;</span></button></a></li>';L(r,e);e='<div class="tab-pane" id="'+t+'-tab-content" role="tabpanel" aria-labelledby="'+t+'-tab" ><iframe src="'+c+'" width="100%" frameborder="no" border="0" marginwidth="0" marginheight="0" ></iframe></div>';L(o,e);D(t);w(t);const l=document.querySelector("#"+t+"-tab");O(l);const a=l.querySelector("button.close");T(a)}else{e=true}if(e){const i=s.getAttribute("aria-controls");const u=document.querySelector(i);if(u!==null){const d=u.querySelector("iframe");if(d!==null){d.contentWindow?.location.reload()}}w(i.replace("-tab-content",""))}};var M=e=>{for(const t of e){if(!t.classList.contains(J)){t.addEventListener("click",e=>{e.preventDefault();const t=e.currentTarget;const n=document.querySelectorAll(b+" nav");for(const i of n){const u=i.querySelectorAll("a."+y);if(u!==null){for(const d of u){const f=d.classList;f.remove(y);f.add(q)}}}const c=t.getAttribute("href");const r=t.getAttribute("id");const o=t.querySelector("p")?.textContent;W(r,o,c);const s=t.classList;s.remove(q);s.add(y);const l=P(t,b+" nav>ul>li")[0];const a=t.parentElement;if(l!==a){const m=l.querySelector("a");if(m){const v=m.classList;v.remove(q);v.add(y)}}})}else{t.addEventListener("click",e=>{e.preventDefault();const u=e.currentTarget;const d=u.querySelector("i.xq-menu-expand");if(d!==null){const t=u.parentNode;if(d.classList.contains(g)){const n=t.querySelector("ul");if(n!==null){d.classList.remove(g);d.classList.add(p);if(n.classList.contains("d-none")){n.classList.remove("d-none")}n.classList.add("d-block")}else{let e;e=u.getAttribute("href");if(e!==null){fetch(e).then(async e=>{return e.json()}).then(e=>{let t;t="<ul>";for(const r of e){const o=r.url;const s=r.id;const l=r.name;const a=r.has_submenu;if(a){t+='<li class="nav-item"><a href="'+o+'" class="nav-link xq-menu" id="t_'+s+'">';t+='<i class="nav-icon bi bi-circle"></i><p>'+l+'</p><span class="float-end"><i class="bi xq-menu-expand '+g+'"></i></span>';t+="</a></li>"}else{t+='<li class="nav-item"><a href="'+o+'" class="nav-link" id="t_'+s+'">';t+='<i class="nav-icon bi bi-record-circle"></i><p>'+l+"</p>";t+="</a></li>"}}t+="</ul>";Q(u,t);const n=u.parentNode;const c=n.querySelector("ul");d.classList.remove(g);d.classList.add(p);if(c!==null){if(c.classList.contains("d-none")){c.classList.remove("d-none")}c.classList.add("d-block");const i=c.querySelectorAll("a");M(i)}}).catch(()=>{console.log("url:"+e+",fetch error")})}}}else if(t!==null){const n=t.querySelector("ul");if(n!==null){if(n.classList.contains("d-block")){n.classList.remove("d-block")}n.classList.add("d-none");if(d.classList.contains(p)){d.classList.remove(p)}d.classList.add(g)}}}})}}};var se=()=>{ee();te();const e=document.querySelectorAll(b+" a:not("+S+")");M(e);x()};var le=()=>{const e=document.fullscreenElement??document.msFullscreenElement??document.mozFullScreenElement??document.webkitFullscreenElement??false;if(!e){const t=document.documentElement;const n=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(n){n.call(t)}}else{const c=document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen;if(c){c.call(document)}}};var ae=()=>{const e=document.querySelector(t);if(e!==null){e.addEventListener("click",e=>{e.preventDefault();le()})}};var C=()=>{const e=document.querySelector(m);const t=e.querySelector(".active");return t};var ie=()=>{const e=document.querySelector(f);const t=document.querySelector(m);const n=t.querySelector("li:first-child");const c=Math.abs(Number.parseInt(n.style.marginLeft,10));const r=Number.isNaN(c)?0:c;const o=t.clientWidth+r;const s=e.clientWidth;let l=0;if(o>s){const a=C();const i=t.querySelectorAll("li>a");let e=0;for(const d of i){if(d===a){break}e+=d.clientWidth}const u=o-s;l=e>u?u:e;n.style.marginLeft=(-l).toString()+"px"}else{n.style.marginLeft="0px"}};var ue=()=>{const e=document.querySelector(f);const t=document.querySelector(m);const n=t.querySelector("li:first-child");const c=Number.isNaN(Number.parseInt(n.style.marginLeft,10))?0:Number.parseInt(n.style.marginLeft,10);const r=Math.abs(c);const o=t.clientWidth+r;const s=e.clientWidth;let l=0;if(o>s){const a=C();const i=t.querySelectorAll("li>a");let e=0;for(const u of i){e+=u.clientWidth;if(u===a){break}}if(c<0){l=s-e;n.style.marginLeft=l<0?l.toString()+"px":"0px"}}else{n.style.marginLeft="0px"}};var de=()=>{const e=document.querySelector(n);if(e!==null){e.addEventListener("click",e=>{e.preventDefault();ie()})}};var fe=()=>{const e=document.querySelector(c);if(e!==null){e.addEventListener("click",e=>{e.preventDefault();ue()})}};var me=()=>{ae();de();fe();ce();const{body:e}=document;e.addEventListener("click",e=>{re(e)});oe()};var ve=()=>{window.addEventListener("message",e=>{const t=e.data;const n=t.callback;const c=t.params;if(Object.hasOwn(window,n)){const r=window[n];r.apply(null,c)}})};var be=()=>{G();X();x();N();B();K();se();me();ve()};V(()=>{be()});window.xqAddTab=W})();